[gd_scene load_steps=3 format=3 uid="uid://csxk8gld5gnfv"]

[sub_resource type="GDScript" id="GDScript_wf20g"]
script/source = "#res://ui/seasonal/SummerWorkspace_UI.gd
extends Control
class_name SummerWorkspace_UI

## The Unified Dashboard for Summer Operations.
## Acts as a read-only summary and launcher for the embedded Allocation UI.

# --- Configuration ---
const SEASONS_PER_YEAR: int = 4
const SEASON_NAMES: Array[String] = [\"Spring\", \"Summer\", \"Autumn\", \"Winter\"]

# --- UI References ---
@export_group(\"HUD Components\")
@export var label_silver: Label
@export var label_food: Label
@export var label_wood: Label
@export var label_pop_total: Label
@export var label_pop_idle: Label
@export var texture_winter_warning: TextureRect
@export var btn_hide_ui: Button 

@export_group(\"Labor Summary\")
@export var lbl_summary_farmers: Label
@export var lbl_summary_builders: Label
@export var lbl_summary_raiders: Label
@export var btn_manage_allocation: Button
@export var job_row_container: VBoxContainer ## container where the allocation panel will be injected
@export var allocation_view_scene: PackedScene ## Assign 'SummerAllocation_UI.tscn' here

@export_group(\"War Council\")
@export var container_raid_command: Control 
@export var btn_collapse_toggle: Button
@export var label_authority: Label
@export var label_bondi_count: Label
@export var container_warbands: VBoxContainer
@export var btn_world_map: Button
@export var btn_proceed: Button

@export_group(\"Project Management\")
@export var btn_tab_construction: Button
@export var btn_tab_completed: Button
@export var grid_active_projects: GridContainer
@export var grid_completed_buildings: GridContainer

# --- Internal References ---
@onready var background_layer: TextureRect = $BackgroundLayer
@onready var layout_root: VBoxContainer = $LayoutRoot

# Runtime generated nodes
var btn_restore_ui: Button 
var allocation_instance: Control

# --- State ---
var is_raid_panel_open: bool = true
var _has_activated: bool = false

func _ready() -> void:
	visible = false
	
	_setup_mouse_filters()
	_setup_signals()
	_connect_buttons()
	_create_restore_button()
	
	if DynastyManager.current_season == DynastyManager.Season.SUMMER:
		_activate_summer_ui()
	
	_set_project_view(true)

func _create_restore_button() -> void:
	btn_restore_ui = Button.new()
	btn_restore_ui.text = \"Open Summer Council\"
	btn_restore_ui.visible = false
	btn_restore_ui.top_level = true
	btn_restore_ui.anchor_left = 1.0
	btn_restore_ui.anchor_top = 1.0
	btn_restore_ui.anchor_right = 1.0
	btn_restore_ui.anchor_bottom = 1.0
	btn_restore_ui.offset_left = -220
	btn_restore_ui.offset_top = -60
	btn_restore_ui.offset_right = -20
	btn_restore_ui.offset_bottom = -20
	btn_restore_ui.pressed.connect(_on_restore_ui_pressed)
	add_child(btn_restore_ui)

func _connect_buttons() -> void:
	if btn_collapse_toggle: btn_collapse_toggle.pressed.connect(_toggle_raid_panel)
	if btn_world_map: btn_world_map.pressed.connect(func(): EventBus.scene_change_requested.emit(GameScenes.WORLD_MAP)) 
	if btn_proceed: btn_proceed.pressed.connect(_on_proceed_pressed)
	if btn_tab_construction: btn_tab_construction.pressed.connect(func(): _set_project_view(true))
	if btn_tab_completed: btn_tab_completed.pressed.connect(func(): _set_project_view(false))
	if btn_hide_ui: btn_hide_ui.pressed.connect(_on_hide_ui_pressed)
	if btn_manage_allocation: btn_manage_allocation.pressed.connect(_on_manage_allocation_pressed)

func _activate_summer_ui() -> void:
	visible = true
	_initial_refresh() 
	_has_activated = true
	Loggie.msg(\"Summer UI Activated\").domain(LogDomains.UI).info()

func _setup_mouse_filters() -> void:
	self.mouse_filter = Control.MOUSE_FILTER_IGNORE
	if layout_root:
		layout_root.mouse_filter = Control.MOUSE_FILTER_IGNORE
		for child in layout_root.get_children():
			if child is Control: child.mouse_filter = Control.MOUSE_FILTER_IGNORE
	if background_layer:
		background_layer.mouse_filter = Control.MOUSE_FILTER_IGNORE

func _setup_signals() -> void:
	EventBus.settlement_loaded.connect(_on_settlement_loaded)
	EventBus.treasury_updated.connect(_on_treasury_updated)
	EventBus.population_changed.connect(_on_population_changed)
	EventBus.season_changed.connect(_on_season_changed)

# --- Visibility Toggles ---

func _on_hide_ui_pressed() -> void:
	if layout_root: layout_root.visible = false
	if background_layer: background_layer.visible = false
	if btn_restore_ui: btn_restore_ui.visible = true

func _on_restore_ui_pressed() -> void:
	if layout_root: layout_root.visible = true
	if background_layer: background_layer.visible = true
	if btn_restore_ui: btn_restore_ui.visible = false

# --- Data & Logic Initialization ---

func _initial_refresh() -> void:
	if not EconomyManager or not SettlementManager or not DynastyManager: return
	if not SettlementManager.current_settlement: return

	_update_resources(EconomyManager.get_projected_income()) 
	_update_authority_display()
	_update_forecast_warning()
	
	_refresh_labor_summary()
	_update_population_display()
	_refresh_building_grids()

func _refresh_labor_summary() -> void:
	if not SettlementManager.current_settlement: return
	
	var placed = SettlementManager.current_settlement.placed_buildings
	var pending = SettlementManager.current_settlement.pending_construction_buildings
	
	var current_farmers = 0
	for b in placed: current_farmers += b.get(\"assigned_workers\", 0)
	
	var current_builders = 0
	for b in pending: current_builders += b.get(\"peasant_count\", 0)
	
	# Raiders are tracked by EconomyManager/RaidManager usually, assuming 0 for now if not tracked in a var
	# If you have a variable for this, replace 0 below.
	var current_raiders = 0 
	
	if lbl_summary_farmers: lbl_summary_farmers.text = \"Farming: %d\" % current_farmers
	if lbl_summary_builders: lbl_summary_builders.text = \"Construction: %d\" % current_builders
	if lbl_summary_raiders: lbl_summary_raiders.text = \"Raiders: %d\" % current_raiders
	
	if label_bondi_count: label_bondi_count.text = str(current_raiders)

func _update_population_display() -> void:
	if not SettlementManager.current_settlement: return
	
	var total = SettlementManager.current_settlement.population_peasants
	var idle = SettlementManager.get_idle_peasants()
	
	if label_pop_total: label_pop_total.text = \"Pop: %d\" % total
	if label_pop_idle: label_pop_idle.text = \"(%d Idle)\" % idle
	
	var no_labor = idle <= 0
	label_pop_idle.modulate = Color.RED if no_labor else Color.WHITE

# --- External Allocation UI (Embedded) ---

func _on_manage_allocation_pressed() -> void:
	if not allocation_view_scene:
		Loggie.msg(\"Allocation Scene not assigned in SummerWorkspace_UI!\").domain(LogDomains.UI).error()
		return
	
	# If panel exists, just toggle it
	if allocation_instance:
		allocation_instance.visible = not allocation_instance.visible
		return

	# Otherwise, instantiate it embedded in the column
	if not job_row_container:
		Loggie.msg(\"JobRowContainer not assigned! Cannot embed Allocation UI.\").domain(LogDomains.UI).error()
		return
		
	allocation_instance = allocation_view_scene.instantiate()
	allocation_instance.name = \"AllocationPanel\"
	
	# Add to the VBox (JobRow_Container) so it sits below the button
	job_row_container.add_child(allocation_instance)
	
	# Configure layout to fit nicely in the column
	allocation_instance.size_flags_horizontal = Control.SIZE_EXPAND_FILL
	allocation_instance.size_flags_vertical = Control.SIZE_SHRINK_BEGIN
	
	# Connect refresh signal
	if allocation_instance.has_signal(\"allocation_committed\"):
		allocation_instance.allocation_committed.connect(_on_allocation_committed)

func _on_allocation_committed() -> void:
	Loggie.msg(\"Allocation Committed - Refreshing Dashboard\").domain(LogDomains.UI).info()
	_initial_refresh()
	# Optional: Hide panel on commit?
	# if allocation_instance: allocation_instance.visible = false

# --- Projections & Forecasts ---

func _update_resources(treasury: Dictionary) -> void:
	if label_silver: label_silver.text = str(treasury.get(\"gold\", 0))
	if label_food: label_food.text = str(treasury.get(\"food\", 0))
	if label_wood: label_wood.text = str(treasury.get(\"wood\", 0))

func _update_authority_display() -> void:
	if not DynastyManager.current_jarl: return
	var auth = DynastyManager.current_jarl.current_authority
	if label_authority: label_authority.text = \"Authority: %d\" % auth

func _update_forecast_warning() -> void:
	if not SettlementManager.current_settlement: return
	
	var forecast = EconomyManager.get_winter_forecast()
	var base_food_demand = forecast.get(\"food\", 0)
	var current_food = SettlementManager.current_settlement.treasury.get(\"food\", 0)
	
	if current_food < base_food_demand:
		texture_winter_warning.modulate = Color.RED
		texture_winter_warning.tooltip_text = \"Deficit Predicted! Demand: %d\" % base_food_demand
	else:
		texture_winter_warning.modulate = Color.GREEN
		texture_winter_warning.tooltip_text = \"Winter Secure.\"

func _refresh_building_grids() -> void:
	if not grid_active_projects or not grid_completed_buildings: return
	
	for child in grid_active_projects.get_children(): child.queue_free()
	for child in grid_completed_buildings.get_children(): child.queue_free()
	
	# Completed
	for b in SettlementManager.current_settlement.placed_buildings:
		var lbl = Label.new()
		var b_name = \"Building\"
		if \"resource_path\" in b:
			var b_data = load(b[\"resource_path\"])
			if b_data:
				b_name = b_data.display_name if \"display_name\" in b_data else b_data.resource_name
		
		lbl.text = str(b_name).capitalize() + \" (Complete)\"
		grid_completed_buildings.add_child(lbl)
		
	# Construction
	var pending = SettlementManager.current_settlement.get(\"pending_construction_buildings\")
	if pending and pending is Array:
		for i in range(pending.size()):
			var b = pending[i]
			var lbl = Label.new()
			var b_name = \"Site\"
			if \"resource_path\" in b:
				var b_data = load(b[\"resource_path\"])
				if b_data:
					b_name = b_data.display_name if \"display_name\" in b_data else b_data.resource_name
			
			var assigned = b.get(\"peasant_count\", 0)
			var status_str = \"(Paused)\" if assigned == 0 else \"(Active: %d)\" % assigned
			if assigned == 0: lbl.modulate = Color.GRAY
			
			lbl.text = \"%s %s\" % [str(b_name).capitalize(), status_str]
			grid_active_projects.add_child(lbl)

# --- Commit / Phase Logic ---

func _on_proceed_pressed() -> void:
	SettlementManager._validate_employment_levels()
	Loggie.msg(\"Summer Ended. Proceeding to Autumn.\").domain(LogDomains.GAMEPLAY).info()
	queue_free()

# --- Standard Handlers ---

func _on_settlement_loaded(_data) -> void:
	if visible: _initial_refresh()

func _on_treasury_updated(new_treasury: Dictionary) -> void:
	if visible: _update_resources(new_treasury); _update_forecast_warning()

func _on_population_changed() -> void:
	if visible: _initial_refresh()

func _on_season_changed(new_season: String, _context: Dictionary) -> void:
	if new_season == \"Summer\": _activate_summer_ui()
	else: visible = false

func _toggle_raid_panel() -> void:
	is_raid_panel_open = !is_raid_panel_open
	var tween = create_tween()
	tween.set_trans(Tween.TRANS_CUBIC).set_ease(Tween.EASE_OUT).set_parallel(true)
	if is_raid_panel_open:
		container_raid_command.show()
		tween.tween_property(container_raid_command, \"modulate:a\", 1.0, 0.15)
		btn_collapse_toggle.text = \"▼ War Council\"
	else:
		tween.tween_property(container_raid_command, \"modulate:a\", 0.0, 0.1)
		tween.chain().tween_callback(container_raid_command.hide)
		btn_collapse_toggle.text = \"▲ War Council\"

func _set_project_view(show_construction: bool) -> void:
	if grid_active_projects: grid_active_projects.visible = show_construction
	if grid_completed_buildings: grid_completed_buildings.visible = !show_construction
	if btn_tab_construction: btn_tab_construction.set_pressed_no_signal(show_construction)
	if btn_tab_completed: btn_tab_completed.set_pressed_no_signal(!show_construction)
"

[sub_resource type="Resource" id="Resource_vwey1"]
metadata/__load_path__ = "res://ui/seasonal/[Deprecated] SummerAllocation_Ui.tscn"

[node name="SummerWorkspace_UI" type="Control" node_paths=PackedStringArray("label_silver", "label_food", "label_wood", "label_pop_total", "label_pop_idle", "texture_winter_warning", "btn_hide_ui", "lbl_summary_farmers", "lbl_summary_builders", "lbl_summary_raiders", "btn_manage_allocation", "job_row_container", "container_raid_command", "btn_collapse_toggle", "label_authority", "label_bondi_count", "container_warbands", "btn_world_map", "btn_proceed", "btn_tab_construction", "btn_tab_completed", "grid_active_projects", "grid_completed_buildings")]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = SubResource("GDScript_wf20g")
label_silver = NodePath("LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/SilverWidget/Label_Value")
label_food = NodePath("LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/FoodWidget/Label_Value")
label_wood = NodePath("LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/WoodWidget/Label_Value")
label_pop_total = NodePath("LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/PopWidget/Label_Total")
label_pop_idle = NodePath("LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/PopWidget/Label_Idle")
texture_winter_warning = NodePath("LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/WinterWarning")
btn_hide_ui = NodePath("LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/CloseButton")
lbl_summary_farmers = NodePath("LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container/Label_Farmers")
lbl_summary_builders = NodePath("LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container/Label_Builders")
lbl_summary_raiders = NodePath("LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container/Label_Raiders")
btn_manage_allocation = NodePath("LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container/Btn_ManageAllocation")
job_row_container = NodePath("LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container")
allocation_view_scene = SubResource("Resource_vwey1")
container_raid_command = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container")
btn_collapse_toggle = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/CollapseToggle")
label_authority = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/CommandHeader/Label_Authority")
label_bondi_count = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/TroopBreakdown/BondiCount/Label_Value")
container_warbands = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/TroopBreakdown/WarbandList")
btn_world_map = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/WorldMapButton")
btn_proceed = NodePath("LayoutRoot/Footer_Commitment/MarginContainer/ProceedButton")
btn_tab_construction = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/ProjectTabs/Btn_ShowConstruction")
btn_tab_completed = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/ProjectTabs/Btn_ShowCompleted")
grid_active_projects = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/ActiveProjects_Grid")
grid_completed_buildings = NodePath("LayoutRoot/MainWorkspace/VisualizationColumn/CompletedBuildings_Grid")

[node name="BackgroundLayer" type="TextureRect" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
expand_mode = 1
stretch_mode = 6

[node name="LayoutRoot" type="VBoxContainer" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 0

[node name="HUD_TopBar" type="PanelContainer" parent="LayoutRoot"]
layout_mode = 2
size_flags_vertical = 0

[node name="MarginContainer" type="MarginContainer" parent="LayoutRoot/HUD_TopBar"]
layout_mode = 2
theme_override_constants/margin_left = 20
theme_override_constants/margin_top = 10
theme_override_constants/margin_right = 20
theme_override_constants/margin_bottom = 10

[node name="HBoxContainer" type="HBoxContainer" parent="LayoutRoot/HUD_TopBar/MarginContainer"]
layout_mode = 2
theme_override_constants/separation = 40

[node name="ResourceGroup" type="HBoxContainer" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 20

[node name="SilverWidget" type="HBoxContainer" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup"]
layout_mode = 2

[node name="Icon" type="TextureRect" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/SilverWidget"]
layout_mode = 2
expand_mode = 2

[node name="Label_Value" type="Label" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/SilverWidget"]
layout_mode = 2
text = "0"

[node name="FoodWidget" type="HBoxContainer" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup"]
layout_mode = 2

[node name="Icon" type="TextureRect" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/FoodWidget"]
layout_mode = 2
expand_mode = 2

[node name="Label_Value" type="Label" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/FoodWidget"]
layout_mode = 2
text = "0 / +0"

[node name="WoodWidget" type="HBoxContainer" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup"]
layout_mode = 2

[node name="Icon" type="TextureRect" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/WoodWidget"]
layout_mode = 2
expand_mode = 2

[node name="Label_Value" type="Label" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/ResourceGroup/WoodWidget"]
layout_mode = 2
text = "0"

[node name="PopWidget" type="HBoxContainer" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 10

[node name="Icon" type="TextureRect" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/PopWidget"]
layout_mode = 2
expand_mode = 2

[node name="Label_Total" type="Label" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/PopWidget"]
layout_mode = 2
text = "Pop: 10"

[node name="Label_Idle" type="Label" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer/PopWidget"]
layout_mode = 2
text = "(3 Idle)"

[node name="WinterWarning" type="TextureRect" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer"]
custom_minimum_size = Vector2(32, 32)
layout_mode = 2
expand_mode = 1
stretch_mode = 5

[node name="CloseButton" type="Button" parent="LayoutRoot/HUD_TopBar/MarginContainer/HBoxContainer"]
layout_mode = 2

[node name="MainWorkspace" type="HBoxContainer" parent="LayoutRoot"]
layout_mode = 2
size_flags_vertical = 3
theme_override_constants/separation = 20

[node name="LaborColumn" type="VBoxContainer" parent="LayoutRoot/MainWorkspace"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_stretch_ratio = 0.4

[node name="Header" type="Label" parent="LayoutRoot/MainWorkspace/LaborColumn"]
layout_mode = 2
text = "Summer Assignments"
horizontal_alignment = 1

[node name="HSeparator" type="HSeparator" parent="LayoutRoot/MainWorkspace/LaborColumn"]
layout_mode = 2

[node name="JobRow_Container" type="VBoxContainer" parent="LayoutRoot/MainWorkspace/LaborColumn"]
layout_mode = 2
size_flags_vertical = 3
theme_override_constants/separation = 15

[node name="Label_Farmers" type="Label" parent="LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container"]
layout_mode = 2
text = "Farming: 0"

[node name="Label_Builders" type="Label" parent="LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container"]
layout_mode = 2
text = "Construction: 0"

[node name="Label_Raiders" type="Label" parent="LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container"]
layout_mode = 2
text = "Raiding: 0"

[node name="Btn_ManageAllocation" type="Button" parent="LayoutRoot/MainWorkspace/LaborColumn/JobRow_Container"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
text = "ALLOCATION"

[node name="VisualizationColumn" type="VBoxContainer" parent="LayoutRoot/MainWorkspace"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_stretch_ratio = 0.6

[node name="ProjectTabs" type="HBoxContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn"]
layout_mode = 2

[node name="Btn_ShowConstruction" type="Button" parent="LayoutRoot/MainWorkspace/VisualizationColumn/ProjectTabs"]
layout_mode = 2
size_flags_horizontal = 3
toggle_mode = true
text = "Under Construction"

[node name="Btn_ShowCompleted" type="Button" parent="LayoutRoot/MainWorkspace/VisualizationColumn/ProjectTabs"]
layout_mode = 2
size_flags_horizontal = 3
toggle_mode = true
text = "Completed"

[node name="ActiveProjects_Grid" type="GridContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn"]
layout_mode = 2
size_flags_vertical = 3
columns = 3

[node name="CompletedBuildings_Grid" type="GridContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn"]
visible = false
layout_mode = 2
size_flags_vertical = 3
columns = 3

[node name="RaidCommand_Section" type="VBoxContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn"]
layout_mode = 2
size_flags_vertical = 3
size_flags_stretch_ratio = 0.5
alignment = 2

[node name="CollapseToggle" type="Button" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section"]
layout_mode = 2
text = "▼ War Council"

[node name="RaidCommand_Container" type="PanelContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section"]
layout_mode = 2
size_flags_vertical = 3

[node name="MarginContainer" type="MarginContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container"]
layout_mode = 2
theme_override_constants/margin_left = 10
theme_override_constants/margin_top = 10
theme_override_constants/margin_right = 10
theme_override_constants/margin_bottom = 10

[node name="VBoxContainer" type="VBoxContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer"]
layout_mode = 2

[node name="CommandHeader" type="HBoxContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="Label_Title" type="Label" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/CommandHeader"]
layout_mode = 2
text = "War Council"

[node name="Label_Authority" type="Label" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/CommandHeader"]
layout_mode = 2
size_flags_horizontal = 10
text = "Authority: 0"

[node name="HSeparator" type="HSeparator" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="TroopBreakdown" type="VBoxContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3

[node name="BondiCount" type="HBoxContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/TroopBreakdown"]
layout_mode = 2

[node name="Label_Title" type="Label" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/TroopBreakdown/BondiCount"]
layout_mode = 2
text = "Bondi (Villagers):"

[node name="Label_Value" type="Label" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/TroopBreakdown/BondiCount"]
layout_mode = 2
size_flags_horizontal = 10
text = "0"

[node name="WarbandList" type="VBoxContainer" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer/TroopBreakdown"]
layout_mode = 2

[node name="WorldMapButton" type="Button" parent="LayoutRoot/MainWorkspace/VisualizationColumn/RaidCommand_Section/RaidCommand_Container/MarginContainer/VBoxContainer"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
text = "OPEN WORLD MAP"

[node name="Footer_Commitment" type="PanelContainer" parent="LayoutRoot"]
layout_mode = 2

[node name="MarginContainer" type="MarginContainer" parent="LayoutRoot/Footer_Commitment"]
layout_mode = 2
theme_override_constants/margin_left = 50
theme_override_constants/margin_top = 15
theme_override_constants/margin_right = 50
theme_override_constants/margin_bottom = 15

[node name="ProceedButton" type="Button" parent="LayoutRoot/Footer_Commitment/MarginContainer"]
custom_minimum_size = Vector2(0, 50)
layout_mode = 2
text = "The Sun Sets. All Paths are Chosen."
